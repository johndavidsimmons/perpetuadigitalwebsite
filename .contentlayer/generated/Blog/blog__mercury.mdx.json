{
  "title": "Programmatically interacting with an Adobe Target Activity based on the movement of Mercury",
  "date": "2022-12-01T00:00:00.000Z",
  "tags": [
    "adobe target",
    "automation",
    "api",
    "testing"
  ],
  "draft": false,
  "summary": "How to enable/disable a Target test based on an API",
  "body": {
    "raw": "\n## 17th Century Marketing\n\n![mercury](https://images.ctfassets.net/on47yk52ubpi/2qps9JbE6GR1Qbe3zSM3nD/6e51e1d7536978880a215babe59a1267/0_JZ1V0NtFXgCHaWc0.jpg)\n\n<figure>\n  <figcaption>That cursed planet</figcaption>\n</figure>\n\nI want offer special sales on products in my webstore _only_ when [Mercury is in retrograde](https://www.almanac.com/content/mercury-retrograde-dates).\nThis happens just a few times a year for about a week at a time.\nIt is known to cause online shoppers to be especially susceptible to hot deals, amongst other planetary based maladies…\n\n![wizard](https://images.ctfassets.net/on47yk52ubpi/4URGdrgbwcAec4txke1uCo/d65554985491d7d83a1389b2fb53fb57/1_T5t52u_lvDX5VIhrV6a6NA.webp)\n\n<figure>\n  <figcaption>Online shopper purchasing shoes while Mercury is in retrograde</figcaption>\n</figure>\n\nSince I use Adobe Target to display my sales banners, I will just need look through my telescope each\nnight and see if Mercury is in retrograde. If it is, I will go into Target, build my sale content,\nand activate the Activity. I will also need to turn off the Activity when Mercury is _no longer_ in retrograde.\nEither way, I am going outside every night.\n\nSince I don’t even know what Mercury looks like nor do I own a telescope,\nI think I should automate this process. How can I _activate_ my Activity automatically when\nMercury is in retrograde and _deactivate_ it automatically when Mercury is _no longer_ in retrograde?\n\n![my awsome webstore](https://images.ctfassets.net/on47yk52ubpi/1t5axaJdkAJeuzVvVsO8Wm/9f978215d64de0aebf22145fe9f5d288/1_644XDvp_STJQuaJD2TDT5A.webp)\n\n<figure>\n  <figcaption>My awesome webstore</figcaption>\n</figure>\n\nLet’s start by building an XT Activity in Target with a banner displaying some eye catching content:\n\n![target activity](https://images.ctfassets.net/on47yk52ubpi/3e6rhpnxg0baJCY0dTxv8F/0f88d7fdae7f57ae683a40a6028ea0fb/1_fAcwnBx3McWHXNjz0vkQeA.webp)\n\n<figure>\n  <figcaption>An enticing red banner will surely boost my sales.</figcaption>\n</figure>\n\n![live activity](https://images.ctfassets.net/on47yk52ubpi/2OcmfOQryTRfEuzwIdmwJ4/2a4e36829bdfb1369cd93116851f8b9b/1_RDfjqGVRR6cQkH16WMsyIw.webp)\n\n<figure>\n  <figcaption>The sale banner is active, but I don’t know the status of Mercury!</figcaption>\n</figure>\n\n![banner on site](https://images.ctfassets.net/on47yk52ubpi/6X5HhE5go0QBy5LQLduXSd/69da4f88b514c09b2cd3f135420ac155/1_aiX8JyTA5y8P79-aYnEYvQ.webp)\n\n<figure>\n  <figcaption>\n    When people visit myawesomewebstore.com during while Mercury is in retrograde they will be\n    presented with this amazing banner\n  </figcaption>\n</figure>\n\n---\n\nBecause it is 2022 (aka the future) there is API\nfor tracking the movement of Mercury. I can automate turning this activity on and off using this API:\n\n`https://mercuryretrogradeapi.com/`\n\n![merciry api](https://images.ctfassets.net/on47yk52ubpi/2bobDMHJTCRWSYgNKZ1Qvf/bca2791232301130221f80b60d5904a0/1_C4rBV4w9FnEommSJb5_cow.webp)\n\n<figure>\n  <figcaption>The future is crazy</figcaption>\n</figure>\n\n---\n\nBefore writing any automation code, the first thing to do is hop over to the Adobe Developer Console\nand start a new project that has access to the Target API. If you have never done that before I won’t bore\nyou with it here. Information how to setup API projects is here: https://developer.adobe.com/developer-console/\n\nOnce I have my API keys I can now interact with Target via its API.\nNormally, I would do this in Python, but Adobe has some excellent Node JS\nlibraries that unfortunately you have to dig to find. Seriously, look around on NPM. Here is what I will be using:\n\n- [Target AIO Node JS library](https://www.npmjs.com/package/@adobe/aio-lib-target) - _interact with Target activities_\n- [Adobe Authentication library](https://www.npmjs.com/package/@adobe/jwt-auth) - _Authenticate with Adobe to make API calls_\n- [Axios](https://www.npmjs.com/package/axios) - _Call the Retrograde API_\n- [dotenv](https://www.npmjs.com/package/dotenv) - _read a .env file with environment variables (API creds)_\n\n```javascript\nconst auth = require('@adobe/jwt-auth')\nconst axios = require('axios')\nconst dotenv = require('dotenv')\nconst targetSDK = require('@adobe/aio-lib-target')\n\n// get my env variables\ndotenv.config()\n\n// Adobe API Config vars\nconst config = {\n  clientId: process.env.clientId,\n  clientSecret: process.env.clientSecret,\n  technicalAccountId: process.env.technicalAccountId,\n  orgId: process.env.orgId,\n  metaScopes: ['ent_marketing_sdk'],\n  privateKey: process.env.privateKey.replace(/\\\\n/g, '\\n'), // make the PK readable as a string\n}\n```\n\n_Note: I am storing my private key in an environment variable here so I don’t have to read it from a file_\n\nIn my code I need a function to tell me if Mercury is or is not in retrograde by calling the Mercury API.\nI will use this function to control whether the activity should be activated or deactivated.\n\n```javascript\n// returns boolean\nconst isRetrograde = async () => {\n  const response = await axios.get(`https://mercuryretrogradeapi.com/`)\n  return response.data.is_retrograde\n}\n```\n\nNow all I need is the method from the Target SDK for updating Activity States.\nNote that I have removed my actual activity in the example code, but you can find that ID on the Activity Overview page:\n\n![activity overview](https://images.ctfassets.net/on47yk52ubpi/4pT3bmiRqrRenAQMQh8GH5/63dc022246db633855d2ae2fb3ad04a3/1_AubM8SaszQPWLk6Pe_3Mgg.webp)\n\n```javascript\nasync function updateActivity() {\n  let activateTest = await isRetrograde()\n  let { access_token } = await auth(config)\n  const targetClient = await targetSDK.init(\n    process.env.companyID,\n    process.env.clientId,\n    access_token\n  )\n\n  const options = {\n    headers: {\n      'content-type': 'application/vnd.adobe.target.v1+json',\n      Accept: 'application/vnd.adobe.target.v1+json',\n    },\n  }\n  // - approved : corresponds to Live in Target UI.\n  // - deactivated : corresponds to Inactive in Target UI.\n  // - saved : corresponds to Inactive in Target UI.\n  const updateActivityState = await targetClient.setActivityState(\n    123456,\n    activateTest ? 'approved' : 'saved',\n    options\n  )\n\n  //   //get offer by id activity\n  const activity = await targetClient.getABActivityById(123456)\n  console.log(activity)\n  return\n}\n\n// call to change activity state\nupdateActivity()\n```\n\nHere is the whole file I’ll call _mercury.js_\n\n```javascript\nconst auth = require('@adobe/jwt-auth')\nconst axios = require('axios')\nconst dotenv = require('dotenv')\nconst targetSDK = require('@adobe/aio-lib-target')\n\n// get my env variables\ndotenv.config()\n\n// Adobe API Config vars\nconst config = {\n  clientId: process.env.clientId,\n  clientSecret: process.env.clientSecret,\n  technicalAccountId: process.env.technicalAccountId,\n  orgId: process.env.orgId,\n  metaScopes: ['ent_marketing_sdk'],\n  privateKey: process.env.privateKey.replace(/\\\\n/g, '\\n'), // make the PK readable as a string\n}\n\n// returns boolean\nconst isRetrograde = async () => {\n  const response = await axios.get(`https://mercuryretrogradeapi.com/`)\n  const { is_retrograde } = response.data\n  return is_retrograde\n}\n\nasync function updateActivity() {\n  let activateTest = await isRetrograde()\n  let { access_token } = await auth(config)\n  const targetClient = await targetSDK.init(\n    process.env.companyID,\n    process.env.clientId,\n    access_token\n  )\n\n  const options = {\n    headers: {\n      'content-type': 'application/vnd.adobe.target.v1+json',\n      Accept: 'application/vnd.adobe.target.v1+json',\n    },\n  }\n  // - approved : corresponds to Live in Target UI.\n  // - deactivated : corresponds to Inactive in Target UI.\n  // - saved : corresponds to Inactive in Target UI.\n  const updateActivityState = await targetClient.setActivityState(\n    12345,\n    activateTest ? 'approved' : 'saved',\n    options\n  )\n\n  //   //get offer by id activity\n  const activity = await targetClient.getABActivityById(12345)\n  console.log(activity)\n  return\n}\n\nupdateActivity()\n```\n\nA few things to note in the code above:\n\nFirst, the _setActivityState_ method in the SDK needs some special media-type headers specified in the options.\nThe SDK doesn’t have this built into the methods nor does it specify anything in the method definitions, but it is required.\nIf you get [415 errors](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/415#:~:text=The%20HTTP%20415%20Unsupported%20Media,of%20inspecting%20the%20data%20directly.)\nwith any methods, double check the headers from this document: https://developers.adobetarget.com/api/\n\nThe second parameter in _setActivityState_ is a ternary operator based on what the Retrograde API gives back.\nIf Mercury is in retrograde (true from the API) the activity will be set to _approved_. If retrograde is false, the activity will be _deactivated_.\nThese statuses are kind of vague, and don’t reflect the terminology in the Target UI which is annoying. The definitions in the comments are taken directly from the docs.\nI am not sure what the difference between _saved_ and _deactivated_ is exactly. Anyway, you get the point. Let’s get to the fun part…\n\n---\n\n## Automation\n\nThere’s a couple options here to automate this. You could use an AWS Lambda,\nbut then you have to learn about deploying a node project in lambda and how to schedule cron jobs through AWS Event Bridge.\nThese tasks are actually trickier than they sound if you’ve never done it before. Rather than give Amazon more money,\ninstead, I’ll give Akamai some money and use a Linode virtual machine.Then I can use it to run lots of different cron jobs.\nIf you have never used Linode before, check out their [Youtube channel](https://www.youtube.com/@linode).\nI can either spin up a new virtual machine preloaded with NodeJS or spin up a blank one and install Node manually. I will choose the former.\n\nAfter creating my virtual machine and verifying [I can connect to it via SSH](https://www.linode.com/docs/guides/networking/ssh/),\nI transfer my _mercury.js_ file and _package.json_ file [via SCP](https://www.ssh.com/academy/ssh/scp#basic-usage).\nRegarding environment variables, I can transfer my .env also, or set them directly on the virtual machine.\nYour choice. Once the files are transferred, I can navigate to their directory and run _npm i_ to install all packages I will need.\nI’ll also run _mercury.js_ a couple times to make sure everything works:\n\n```bash\n# transfer files via scp from source machine to VM\n# scp <source> <username@destination>\nscp mercury.js root@192.168.0.1:/home/mercury/mercury.js\n\n# scp other files...\n\n#SSH into my virtual machine. (Not the real IP address :) )\nssh root@192.168.0.1\n\n# move to mercury directory and install node libraries\ncd mercury && npm i\n\n# run the file to make sure it works!\nnode mercury.js\n```\n\nOnce I have verified that everything works I can now instruct my virtual machine to run this as often as I want.\nI think daily will suffice as Mercury doesn’t move that fast. To do this I just need to edit my virtual machine’s\ncrontab file. Cron jobs are a way to tell a Linux computer to execute a specific task at a specific time.\n[Please see this excellent video from Linode about writing cron jobs.](https://youtu.be/v952m13p-b4)\n\nIn the end, my _crontab_ file will have this at the bottom:\n\n```bash\n# etc\n# etc\n# m h dom mon dow\n0 8 * * * cd /somepath/mercury && node mercury.js\n```\n\nBasically this says “_every day at 8am, run mercury.js_”. Every day, this command will run and mercury.js will\nactivate/deactivate my activity based on what the mercury API says. Once I save my _crontab_ file,\nI have effectively created an Adobe Target Activity that is conditionally active based on the movement of a planet! The future is crazy.\n\n![active test](https://images.ctfassets.net/on47yk52ubpi/3o4BxcVYr5MAkyxCZKnVyO/3b24d1e0ba2a2c5710a255f65bbaa22b/1_DvRL0HerPI6zK1fxgHp0Tw.webp)\n\n_A quick note: the target UI doesn’t always update immediately to reflect API changes, but you can verify that the activity is activated via the Changelog section. The UI changes will show up after a few minutes._\n\nNow this example is _trivial_, some might even call it stupid (_how dare you!_), but the set up is real.\nWhat if you run all types of date specific Target activities? Black Friday, Cyber Monday, Super Bowl,\nPresident’s Day, Flag Day, John’s birthday, and so on. I could have all sorts of Target Activities that\nprogrammatically turn on and off based on the date. With some initial setup, I could plan out a whole year of sales banners in a few hours!\n",
    "code": "var Component=(()=>{var d=Object.create;var l=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var N=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=>{for(var c in s)l(a,c,{get:s[c],enumerable:!0})},i=(a,s,c,n)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let t of h(s))!u.call(a,t)&&t!==c&&l(a,t,{get:()=>s[t],enumerable:!(n=p(s,t))||n.enumerable});return a};var y=(a,s,c)=>(c=a!=null?d(m(a)):{},i(s||!a||!a.__esModule?l(c,\"default\",{value:a,enumerable:!0}):c,a)),g=a=>i(l({},\"__esModule\",{value:!0}),a);var r=N((A,o)=>{o.exports=_jsx_runtime});var b={};k(b,{default:()=>w,frontmatter:()=>f});var e=y(r()),f={title:\"Programmatically interacting with an Adobe Target Activity based on the movement of Mercury\",date:\"2022-12-01\",tags:[\"adobe target\",\"automation\",\"api\",\"testing\"],draft:!1,summary:\"How to enable/disable a Target test based on an API\"};function v(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",img:\"img\",em:\"em\",hr:\"hr\",code:\"code\",ul:\"ul\",li:\"li\",pre:\"pre\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"17th-century-marketing\",children:[(0,e.jsx)(n.a,{href:\"#17th-century-marketing\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"17th Century Marketing\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"mercury\",src:\"https://images.ctfassets.net/on47yk52ubpi/2qps9JbE6GR1Qbe3zSM3nD/6e51e1d7536978880a215babe59a1267/0_JZ1V0NtFXgCHaWc0.jpg\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"That cursed planet\"})}),(0,e.jsxs)(n.p,{children:[\"I want offer special sales on products in my webstore \",(0,e.jsx)(n.em,{children:\"only\"}),\" when \",(0,e.jsx)(n.a,{href:\"https://www.almanac.com/content/mercury-retrograde-dates\",children:\"Mercury is in retrograde\"}),\". This happens just a few times a year for about a week at a time. It is known to cause online shoppers to be especially susceptible to hot deals, amongst other planetary based maladies\\u2026\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"wizard\",src:\"https://images.ctfassets.net/on47yk52ubpi/4URGdrgbwcAec4txke1uCo/d65554985491d7d83a1389b2fb53fb57/1_T5t52u_lvDX5VIhrV6a6NA.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"Online shopper purchasing shoes while Mercury is in retrograde\"})}),(0,e.jsxs)(n.p,{children:[\"Since I use Adobe Target to display my sales banners, I will just need look through my telescope each night and see if Mercury is in retrograde. If it is, I will go into Target, build my sale content, and activate the Activity. I will also need to turn off the Activity when Mercury is \",(0,e.jsx)(n.em,{children:\"no longer\"}),\" in retrograde. Either way, I am going outside every night.\"]}),(0,e.jsxs)(n.p,{children:[\"Since I don\\u2019t even know what Mercury looks like nor do I own a telescope, I think I should automate this process. How can I \",(0,e.jsx)(n.em,{children:\"activate\"}),\" my Activity automatically when Mercury is in retrograde and \",(0,e.jsx)(n.em,{children:\"deactivate\"}),\" it automatically when Mercury is \",(0,e.jsx)(n.em,{children:\"no longer\"}),\" in retrograde?\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"my awsome webstore\",src:\"https://images.ctfassets.net/on47yk52ubpi/1t5axaJdkAJeuzVvVsO8Wm/9f978215d64de0aebf22145fe9f5d288/1_644XDvp_STJQuaJD2TDT5A.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"My awesome webstore\"})}),(0,e.jsx)(n.p,{children:\"Let\\u2019s start by building an XT Activity in Target with a banner displaying some eye catching content:\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"target activity\",src:\"https://images.ctfassets.net/on47yk52ubpi/3e6rhpnxg0baJCY0dTxv8F/0f88d7fdae7f57ae683a40a6028ea0fb/1_fAcwnBx3McWHXNjz0vkQeA.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"An enticing red banner will surely boost my sales.\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"live activity\",src:\"https://images.ctfassets.net/on47yk52ubpi/2OcmfOQryTRfEuzwIdmwJ4/2a4e36829bdfb1369cd93116851f8b9b/1_RDfjqGVRR6cQkH16WMsyIw.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"The sale banner is active, but I don\\u2019t know the status of Mercury!\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"banner on site\",src:\"https://images.ctfassets.net/on47yk52ubpi/6X5HhE5go0QBy5LQLduXSd/69da4f88b514c09b2cd3f135420ac155/1_aiX8JyTA5y8P79-aYnEYvQ.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:(0,e.jsx)(n.p,{children:\"When people visit myawesomewebstore.com during while Mercury is in retrograde they will be presented with this amazing banner\"})})}),(0,e.jsx)(n.hr,{}),(0,e.jsx)(n.p,{children:\"Because it is 2022 (aka the future) there is API for tracking the movement of Mercury. I can automate turning this activity on and off using this API:\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.code,{children:\"https://mercuryretrogradeapi.com/\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"merciry api\",src:\"https://images.ctfassets.net/on47yk52ubpi/2bobDMHJTCRWSYgNKZ1Qvf/bca2791232301130221f80b60d5904a0/1_C4rBV4w9FnEommSJb5_cow.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"The future is crazy\"})}),(0,e.jsx)(n.hr,{}),(0,e.jsxs)(n.p,{children:[\"Before writing any automation code, the first thing to do is hop over to the Adobe Developer Console and start a new project that has access to the Target API. If you have never done that before I won\\u2019t bore you with it here. Information how to setup API projects is here: \",(0,e.jsx)(n.a,{href:\"https://developer.adobe.com/developer-console/\",children:\"https://developer.adobe.com/developer-console/\"})]}),(0,e.jsx)(n.p,{children:\"Once I have my API keys I can now interact with Target via its API. Normally, I would do this in Python, but Adobe has some excellent Node JS libraries that unfortunately you have to dig to find. Seriously, look around on NPM. Here is what I will be using:\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.a,{href:\"https://www.npmjs.com/package/@adobe/aio-lib-target\",children:\"Target AIO Node JS library\"}),\" - \",(0,e.jsx)(n.em,{children:\"interact with Target activities\"})]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.a,{href:\"https://www.npmjs.com/package/@adobe/jwt-auth\",children:\"Adobe Authentication library\"}),\" - \",(0,e.jsx)(n.em,{children:\"Authenticate with Adobe to make API calls\"})]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.a,{href:\"https://www.npmjs.com/package/axios\",children:\"Axios\"}),\" - \",(0,e.jsx)(n.em,{children:\"Call the Retrograde API\"})]}),(0,e.jsxs)(n.li,{children:[(0,e.jsx)(n.a,{href:\"https://www.npmjs.com/package/dotenv\",children:\"dotenv\"}),\" - \",(0,e.jsx)(n.em,{children:\"read a .env file with environment variables (API creds)\"})]})]}),(0,e.jsx)(n.pre,{className:\"language-javascript\",children:(0,e.jsxs)(n.code,{className:\"language-javascript code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" auth \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'@adobe/jwt-auth'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" axios \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'axios'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" dotenv \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'dotenv'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" targetSDK \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'@adobe/aio-lib-target'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// get my env variables\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"dotenv\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"config\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Adobe API Config vars\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" config \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  clientId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  clientSecret\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientSecret\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  technicalAccountId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"technicalAccountId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  orgId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"orgId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  metaScopes\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'ent_marketing_sdk'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  privateKey\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"privateKey\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"replace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token regex\",children:[(0,e.jsx)(n.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,e.jsxs)(n.span,{className:\"token language-regex regex-source\",children:[(0,e.jsx)(n.span,{className:\"token escape special-escape\",children:\"\\\\\\\\\"}),\"n\"]}),(0,e.jsx)(n.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token regex-flags\",children:\"g\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'\\\\n'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// make the PK readable as a string\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:\"Note: I am storing my private key in an environment variable here so I don\\u2019t have to read it from a file\"})}),(0,e.jsx)(n.p,{children:\"In my code I need a function to tell me if Mercury is or is not in retrograde by calling the Mercury API. I will use this function to control whether the activity should be activated or deactivated.\"}),(0,e.jsx)(n.pre,{className:\"language-javascript\",children:(0,e.jsxs)(n.code,{className:\"language-javascript code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// returns boolean\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,e.jsx)(n.span,{className:\"token function function-variable\",children:\"isRetrograde\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=>\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" response \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" axios\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"get\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"https://mercuryretrogradeapi.com/\"}),(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" response\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"data\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"is_retrograde\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"Now all I need is the method from the Target SDK for updating Activity States. Note that I have removed my actual activity in the example code, but you can find that ID on the Activity Overview page:\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"activity overview\",src:\"https://images.ctfassets.net/on47yk52ubpi/4pT3bmiRqrRenAQMQh8GH5/63dc022246db633855d2ae2fb3ad04a3/1_AubM8SaszQPWLk6Pe_3Mgg.webp\"})}),(0,e.jsx)(n.pre,{className:\"language-javascript\",children:(0,e.jsxs)(n.code,{className:\"language-javascript code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"updateActivity\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" activateTest \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"isRetrograde\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" access_token \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"auth\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"config\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" targetClient \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetSDK\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"init\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"companyID\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    access_token\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" options \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    headers\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'content-type'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'application/vnd.adobe.target.v1+json'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"Accept\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'application/vnd.adobe.target.v1+json'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// - approved : corresponds to Live in Target UI.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// - deactivated : corresponds to Inactive in Target UI.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// - saved : corresponds to Inactive in Target UI.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" updateActivityState \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"setActivityState\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token number\",children:\"123456\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    activateTest \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'approved'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'saved'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    options\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"//   //get offer by id activity\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" activity \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"getABActivityById\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"123456\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token class-name console\",children:\"console\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"log\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"activity\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// call to change activity state\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"updateActivity\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"Here is the whole file I\\u2019ll call \",(0,e.jsx)(n.em,{children:\"mercury.js\"})]}),(0,e.jsx)(n.pre,{className:\"language-javascript\",children:(0,e.jsxs)(n.code,{className:\"language-javascript code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" auth \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'@adobe/jwt-auth'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" axios \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'axios'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" dotenv \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'dotenv'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" targetSDK \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'@adobe/aio-lib-target'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// get my env variables\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"dotenv\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"config\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Adobe API Config vars\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" config \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  clientId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  clientSecret\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientSecret\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  technicalAccountId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"technicalAccountId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  orgId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"orgId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  metaScopes\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'ent_marketing_sdk'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  privateKey\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"privateKey\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"replace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token regex\",children:[(0,e.jsx)(n.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,e.jsxs)(n.span,{className:\"token language-regex regex-source\",children:[(0,e.jsx)(n.span,{className:\"token escape special-escape\",children:\"\\\\\\\\\"}),\"n\"]}),(0,e.jsx)(n.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token regex-flags\",children:\"g\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'\\\\n'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// make the PK readable as a string\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// returns boolean\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,e.jsx)(n.span,{className:\"token function function-variable\",children:\"isRetrograde\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator arrow\",children:\"=>\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" response \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" axios\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"get\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"https://mercuryretrogradeapi.com/\"}),(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" is_retrograde \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" response\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"data\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),` is_retrograde\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"updateActivity\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" activateTest \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"isRetrograde\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" access_token \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"auth\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"config\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" targetClient \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetSDK\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"init\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"companyID\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    access_token\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" options \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    headers\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'content-type'\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'application/vnd.adobe.target.v1+json'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token maybe-class-name\",children:\"Accept\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'application/vnd.adobe.target.v1+json'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// - approved : corresponds to Live in Target UI.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// - deactivated : corresponds to Inactive in Target UI.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// - saved : corresponds to Inactive in Target UI.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" updateActivityState \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"setActivityState\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token number\",children:\"12345\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    activateTest \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"?\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'approved'\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'saved'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`    options\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"//   //get offer by id activity\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" activity \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"getABActivityById\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"12345\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token class-name console\",children:\"console\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"log\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"activity\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"updateActivity\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"A few things to note in the code above:\"}),(0,e.jsxs)(n.p,{children:[\"First, the \",(0,e.jsx)(n.em,{children:\"setActivityState\"}),\" method in the SDK needs some special media-type headers specified in the options. The SDK doesn\\u2019t have this built into the methods nor does it specify anything in the method definitions, but it is required. If you get \",(0,e.jsx)(n.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/415#:~:text=The%20HTTP%20415%20Unsupported%20Media,of%20inspecting%20the%20data%20directly.\",children:\"415 errors\"}),\" with any methods, double check the headers from this document: \",(0,e.jsx)(n.a,{href:\"https://developers.adobetarget.com/api/\",children:\"https://developers.adobetarget.com/api/\"})]}),(0,e.jsxs)(n.p,{children:[\"The second parameter in \",(0,e.jsx)(n.em,{children:\"setActivityState\"}),\" is a ternary operator based on what the Retrograde API gives back. If Mercury is in retrograde (true from the API) the activity will be set to \",(0,e.jsx)(n.em,{children:\"approved\"}),\". If retrograde is false, the activity will be \",(0,e.jsx)(n.em,{children:\"deactivated\"}),\". These statuses are kind of vague, and don\\u2019t reflect the terminology in the Target UI which is annoying. The definitions in the comments are taken directly from the docs. I am not sure what the difference between \",(0,e.jsx)(n.em,{children:\"saved\"}),\" and \",(0,e.jsx)(n.em,{children:\"deactivated\"}),\" is exactly. Anyway, you get the point. Let\\u2019s get to the fun part\\u2026\"]}),(0,e.jsx)(n.hr,{}),(0,e.jsxs)(n.h2,{id:\"automation\",children:[(0,e.jsx)(n.a,{href:\"#automation\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Automation\"]}),(0,e.jsxs)(n.p,{children:[\"There\\u2019s a couple options here to automate this. You could use an AWS Lambda, but then you have to learn about deploying a node project in lambda and how to schedule cron jobs through AWS Event Bridge. These tasks are actually trickier than they sound if you\\u2019ve never done it before. Rather than give Amazon more money, instead, I\\u2019ll give Akamai some money and use a Linode virtual machine.Then I can use it to run lots of different cron jobs. If you have never used Linode before, check out their \",(0,e.jsx)(n.a,{href:\"https://www.youtube.com/@linode\",children:\"Youtube channel\"}),\". I can either spin up a new virtual machine preloaded with NodeJS or spin up a blank one and install Node manually. I will choose the former.\"]}),(0,e.jsxs)(n.p,{children:[\"After creating my virtual machine and verifying \",(0,e.jsx)(n.a,{href:\"https://www.linode.com/docs/guides/networking/ssh/\",children:\"I can connect to it via SSH\"}),\", I transfer my \",(0,e.jsx)(n.em,{children:\"mercury.js\"}),\" file and \",(0,e.jsx)(n.em,{children:\"package.json\"}),\" file \",(0,e.jsx)(n.a,{href:\"https://www.ssh.com/academy/ssh/scp#basic-usage\",children:\"via SCP\"}),\". Regarding environment variables, I can transfer my .env also, or set them directly on the virtual machine. Your choice. Once the files are transferred, I can navigate to their directory and run \",(0,e.jsx)(n.em,{children:\"npm i\"}),\" to install all packages I will need. I\\u2019ll also run \",(0,e.jsx)(n.em,{children:\"mercury.js\"}),\" a couple times to make sure everything works:\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# transfer files via scp from source machine to VM\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# scp <source> <username@destination>\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"scp\"}),` mercury.js root@192.168.0.1:/home/mercury/mercury.js\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# scp other files...\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"#SSH into my virtual machine. (Not the real IP address :) )\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"ssh\"}),` root@192.168.0.1\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# move to mercury directory and install node libraries\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token class-name builtin\",children:\"cd\"}),\" mercury \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&&\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"npm\"}),` i\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# run the file to make sure it works!\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`node mercury.js\n`})]})}),(0,e.jsxs)(n.p,{children:[\"Once I have verified that everything works I can now instruct my virtual machine to run this as often as I want. I think daily will suffice as Mercury doesn\\u2019t move that fast. To do this I just need to edit my virtual machine\\u2019s crontab file. Cron jobs are a way to tell a Linux computer to execute a specific task at a specific time. \",(0,e.jsx)(n.a,{href:\"https://youtu.be/v952m13p-b4\",children:\"Please see this excellent video from Linode about writing cron jobs.\"})]}),(0,e.jsxs)(n.p,{children:[\"In the end, my \",(0,e.jsx)(n.em,{children:\"crontab\"}),\" file will have this at the bottom:\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# etc\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# etc\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# m h dom mon dow\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"8\"}),\" * * * \",(0,e.jsx)(n.span,{className:\"token class-name builtin\",children:\"cd\"}),\" /somepath/mercury \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"&&\"}),` node mercury.js\n`]})]})}),(0,e.jsxs)(n.p,{children:[\"Basically this says \\u201C\",(0,e.jsx)(n.em,{children:\"every day at 8am, run mercury.js\"}),\"\\u201D. Every day, this command will run and mercury.js will activate/deactivate my activity based on what the mercury API says. Once I save my \",(0,e.jsx)(n.em,{children:\"crontab\"}),\" file, I have effectively created an Adobe Target Activity that is conditionally active based on the movement of a planet! The future is crazy.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"active test\",src:\"https://images.ctfassets.net/on47yk52ubpi/3o4BxcVYr5MAkyxCZKnVyO/3b24d1e0ba2a2c5710a255f65bbaa22b/1_DvRL0HerPI6zK1fxgHp0Tw.webp\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.em,{children:\"A quick note: the target UI doesn\\u2019t always update immediately to reflect API changes, but you can verify that the activity is activated via the Changelog section. The UI changes will show up after a few minutes.\"})}),(0,e.jsxs)(n.p,{children:[\"Now this example is \",(0,e.jsx)(n.em,{children:\"trivial\"}),\", some might even call it stupid (\",(0,e.jsx)(n.em,{children:\"how dare you!\"}),\"), but the set up is real. What if you run all types of date specific Target activities? Black Friday, Cyber Monday, Super Bowl, President\\u2019s Day, Flag Day, John\\u2019s birthday, and so on. I could have all sorts of Target Activities that programmatically turn on and off based on the date. With some initial setup, I could plan out a whole year of sales banners in a few hours!\"]})]})}}var w=v;return g(b);})();\n;return Component;"
  },
  "_id": "blog/mercury.mdx",
  "_raw": {
    "sourceFilePath": "blog/mercury.mdx",
    "sourceFileName": "mercury.mdx",
    "sourceFileDir": "blog",
    "contentType": "mdx",
    "flattenedPath": "blog/mercury"
  },
  "type": "Blog",
  "readingTime": {
    "text": "9 min read",
    "minutes": 8.075,
    "time": 484500,
    "words": 1615
  },
  "slug": "mercury",
  "toc": [
    {
      "value": "17th Century Marketing",
      "url": "#17th-century-marketing",
      "depth": 2
    },
    {
      "value": "Automation",
      "url": "#automation",
      "depth": 2
    }
  ]
}