{
  "title": "Using data from Adobe Analytics in Adobe Target Offers",
  "date": "2022-12-16T00:00:00.000Z",
  "tags": [
    "adobe analytics",
    "adobe target",
    "testing"
  ],
  "draft": false,
  "summary": "How to use data pulled from Adobe Analytics in an Adobe Target offer.",
  "body": {
    "raw": "\n## Do social proof CTAs actually work?\n\nI’m sure everyone has seen those popups on online stores that say something like \n*“15 people are viewing this product right now!”* or *“105 other people from Michigan bought this yesterday!”*. \nI actually looked around for one in the wild to include a screenshot, but of course, when I need one, \nI can’t find one. Anyway, I’m going to build one of those in Target that uses **real data** pulled from Adobe Analytics.\n\n![popupexample](https://images.ctfassets.net/on47yk52ubpi/LX2R2PAXrJFZyJDVmeppD/48d92270accf82b3eb77bf992fcb291f/1_eDd83lpg7ihAxJgoYkfOcw.webp)\n<figure>\n<figcaption>This type of thing!</figcaption>\n</figure>\n\nIn this example, for simplicity, lets say I have a product page, running an A/B activity in Target for all visitors. \n50% of visitors to this page will get a pop up that “encourages” them to make a purchase by saying something \nlike: *“n-number of people viewed this product yesterday!”* and the other 50% of visitors will get the default \nexperience of no such popup. The *n-number* used in the popup content will be a real number of unique visitors \nwho viewed that product page yesterday just as it is reflected in an Adobe Analytics Workspace table. \nThe number will change daily to reflect the previous day’s data relative to the current date; i.e. a \nvisitor on the 12th will see data from the 11th, a visitor on the 13th will see data from the 12th, etc.\n\nThe example I create will be trivial, but concepts will apply to showing *anything* from a workspace table in a Target offer!\n\n## General overview\n\nAs with *almost* everything I write about these days, for the sake of brevity, I have to assume some prior knowledge \nof the [Adobe Developer Console](https://developer.adobe.com/developer-console/), some programming experience, \nand familiarity with Target and Adobe Analytics terminology.\n\nHere are the steps:\n\n* Hack together the popup element using a placeholder number.\n* Save the code from above as a Target Offer. Note the offer ID after saving.\n* Build the activity in Target with the 2 experiences using the [form composer](https://experienceleague.adobe.com/docs/target/using/experiences/form-experience-composer.html?lang=en) and set the delivery content in the variant experience to be the offer I just saved above.\n* In workspace now, build a report that shows the number I want to display in the offer. Use the [Oberon debugger](https://developer.adobe.com/cja-apis/docs/endpoints/reporting/debugger/) to grab the parameters used to make that report as JSON.\n* Setup a developer console project that has access to the Target API and the Adobe Analytics API. I will need the API keys in the next step.\n* Write some NodeJS using the [Adobe AIO libraries](https://www.npmjs.com/search?q=adobe%20aio) to pull that number from workspace and update your Target offer to use that number.\n* Automate the NodeJS above to update the offer with new data every day (or however often you want it to update)\n* *Note: For this example lets assume its a desktop only audience. I would never willingly encourge anyone to put a popup on mobile!*\n\n---\n\n## Build the popup\n\nSince I will be serving a chunk of HTML as my Target offer, I need a self contained, complete piece of code that builds the \npopup, styles it, etc. You could simplify this part by just replacing some static text like a headline or CTA, \nbut I already said popup and my delete key is broken. I don’t remember the keyframes syntax for having things animate \ndirectionally in, so lets just have the popup fade in:\n\n```javascript\nconst popup = document.createElement('div');\npopup.id = 'popup';\nconst content = document.createElement('p');\nconst keyframes = document.createElement('style');\nkeyframes.innerText =\n  '#popup {font-weight: bold !important;height: 100px !important;width: 350px !important;background-color: #fff !important;border: 3px solid red !important;position: absolute !important;bottom: 0 !important;margin: 1em !important;padding: 1em !important;border-radius: 1em !important;-webkit-animation: popin 4s forwards !important;animation-name: popin 4s forwards !important;}@-webkit-keyframes popin {from {opacity: 0;}to {opacity: 1;}}@keyframes popup {from {opacity: 0;}to {opacity: 1;}}';\ndocument.querySelector('head').insertAdjacentElement('beforeend', keyframes);\nlet message = 'n people viewed this product yesterday!';\ncontent.innerText = message;\npopup.appendChild(content);\ndocument.querySelector('body').appendChild(popup);\n```\n\n![n number of people viewed](https://images.ctfassets.net/on47yk52ubpi/6NXOVx8Iv1YkEfzXiVsSVE/ddcb853ac246f7ae28fb0cd2b27ebcc2/1_d_7nt3bXF98bud9bwPeG8w.gif)\n<figure>\n<figcaption>An incredibly enticing popup box with placeholder content. Who are you to resist it?!</figcaption>\n</figure>\n\n## Save it as an offer\n\nNow that I have the popup I want to serve in one of my Target experiences, \nI need to save it as an offer. Once it is saved as an offer, I will be able to deliver it in any \nActivity and more easily interact with it via the Target API.\n\nSince I am technically delivering HTML in need to wrap this code in a `<script>` tag so it is valid HTML:\n![save as offer](https://images.ctfassets.net/on47yk52ubpi/6hwD3HxzfppywMRNNlG63X/0dbc6c41ded784fc5b7843434904f592/1_jQclFe_vk_L19eG8ccRYJw.webp)\n<figure>\n<figcaption>New HTML Offer</figcaption>\n</figure>\n\n![fake offer code](https://images.ctfassets.net/on47yk52ubpi/61fP41uUz2haec6Psdc9hH/ac43f41dd9ed00c448e43df0a7d2f8ee/1_Mxm-OiWKLPnEQwiXPCCQuQ.webp)\n<figure>\n<figcaption>Make sure the code your delivering is valid HTML</figcaption>\n</figure>\n\n![grab the offer id](https://images.ctfassets.net/on47yk52ubpi/2N45TpzFFe6BqcrJiZU54M/3e68a814c42c7b11b3a0eca89839e4dd/1__B06TB_Y1Pu3Es7j6sjjHw.webp)\n<figure>\n<figcaption>Grab the offer ID while you are here!</figcaption>\n</figure>\n\nOnce the offer is saved, bring up this info box by clicking the (i) icon in the modify column and save the Offer ID for later!\n\n## Build the Activity in Target\nIf you’ve never used the form composer, its a little difference than the VEC. \nYou need to have all the specifics of your Activity ready to go. [The official form composer docs are here](https://experienceleague.adobe.com/docs/target/using/experiences/form-experience-composer.html?lang=en).\n\n![form composer setup](https://images.ctfassets.net/on47yk52ubpi/MIMchv6VFEDvOHN1zemC7/49dbf7c0d32566dc11372b188c4b0047/1_vOKzHvOkgSAr-xc0GD1ElQ.webp)\n<figure>\n<figcaption>The setup for my popup offer experience in Target</figcaption>\n</figure>\n\nThat’s it in the Target UI until its time to activate the test!\n\n---\n\n## Getting the data I want to use in my Offer from Adobe Analytics\n\nThe first step to being able to pull the data I want via the API is to generate it from a report in workspace. \nWhile this is not *technically* necessary, Adobe’s Oberon debugging tool makes interacting with the reporting API **much, much** easier. \nHere’s what my desired data looks like in workspace, the number of unique visitors to my product page yesterday:\n\n![workspace setup data](https://images.ctfassets.net/on47yk52ubpi/4qBPqYz8ZxiC8Fwp2Nhqz2/0bfe5046a76fd2555d2ecbe69f5b2827/1_arBiuRigeG2U0Vy2VMLhug.webp)\n<figure>\n<figcaption>1,388 will change every day. Thus the number in the pop up will change every day!</figcaption>\n</figure>\n\nIn order to view (and steal) the underlying API query that made this report, I need to first enable the debugger. \nTo do so, make sure the project is saved and go to *Help > Enable Debugger*. \nEnabling the debugger will add this little bug guy to your freeform tables. \nClick it, and you can see the underlying JSON & XML queries the Adobe Analytics API used to generate the data for the table. \nDepending on how much work you have done on the table, you will also see historical snapshots of queries it has used.\n\n![enable debugger](https://images.ctfassets.net/on47yk52ubpi/5VnYOncJiVuPpjXPcebhPx/ff6502e88fa2f01199dc22e31afe0006/1_kJPPtqkeyVlhteJYYaMu4Q.webp)\n<figure>\n<figcaption>How to enable the debugger</figcaption>\n</figure>\n\n![oberon bug](https://images.ctfassets.net/on47yk52ubpi/5EGfYGHehMBVWNWFtFiyva/fc2b64be16a2d61dd5805db5567567de/1_AFq2k7pVu2MIEW2fjvMr3g.webp)\n<figure>\n<figcaption>Click the little bug fella in your panel</figcaption>\n</figure>\n\nThis is what I am looking for inside the debug view. \nI will use this chunk of JSON later on when I need to programmatically pull this data.\n\n![oberon json](https://images.ctfassets.net/on47yk52ubpi/3LVKr2P63ZnjvRAH4DWwum/d7cab2b8604e7456a37933042a9551b4/1_X9x755hhoK5lcxlHTZ3t6A.webp)\n<figure>\n<figcaption>This is the JSON that Workspace uses to query Adobe Analytics data! In the UI there will also be the response from the API just to the right of here where you will see the data represented.</figcaption>\n</figure>\n\nJumping ahead a little bit, when I make this call via the Node SDK, you can see that the data is the same as in workspace. \nThat is because I am doing the exact same thing workspace is doing!\n\n```javascript\nconst auth = require('@adobe/jwt-auth');\nconst aaSDK = require('@adobe/aio-lib-analytics');\nconst dotenv = require('dotenv');\n\n// get my env variables\ndotenv.config();\n\n// Adobe API Config vars\nconst config = {\n  clientId: process.env.clientId,\n  clientSecret: process.env.clientSecret,\n  technicalAccountId: process.env.technicalAccountId,\n  orgId: process.env.orgId,\n  metaScopes: ['ent_analytics_bulk_ingest_sdk'],\n  privateKey: process.env.privateKey.replace(/\\\\n/g, '\\n'), // make the PK readable as a string\n};\n\n// json query goes here, I left it out here to save space\nconst query = {}\n\n\nasync function getAAData() {\n  // get bearer token\n  let { access_token } = await auth(config);\n\n  //initialize sdk\n  const aaClient = await aaSDK.init(process.env.companyId, config.clientId, access_token);\n\n  // Query the data\n  const myReport = await aaClient.getReport(query);\n\n  console.log(JSON.stringify(myReport.obj.rows, null, 4));\n}\n\ngetAAData();\n```\n\n![code output](https://images.ctfassets.net/on47yk52ubpi/7m583CXdTSSElIfI8aQqot/be989732335a7052055ae3cf4f5249ee/1_q7TZUjU8IY2rmmnAVwGFfQ.webp)\n<figure>\n<figcaption>1388! The same number from workspace!</figcaption>\n</figure>\n\n## Making the query dynamic\n\nIn order to make my query dynamic and return the data from the previous day, I need to inject the previous date into it. \nAlthough the workspace date range says “Yesterday”, in the query you can see it uses actual dates instead of a keyword:\n\n```javascript\nglobalFilters: [\n    {\n      type: 'dateRange',\n      dateRange: '2022-12-13T00:00:00.000/2022-12-14T00:00:00.000',\n    },\n  ],\n```\n\nThis is good though, because that means I can just replace the hardcoded dates with whatever date range I want. \nIn this case, the dates of “today” and “yesterday”\n\n ```javascript\nconst today = new Date();\nconst todayDate = today.toISOString().split('T')[0];\nconst yesterday = today.setDate(today.getDate() - 1);\nconst yesterdayDate = new Date(yesterday).toISOString().split('T')[0];\nconst query = {\n  rsid: process.env.rsid,\n  globalFilters: [\n    {\n      type: 'dateRange',\n      dateRange: `${yesterdayDate}T00:00:00.000/${todayDate}T00:00:00.000`,\n    },\n  ],\n}\n  etc etc .........\n```\n\nThere’s probably a more elegant way to do this way a newer date library from NPM, \nbut this works. So now my report will always pull the previous day’s data, relative to \nthe current date. Exactly the data I want to use in my dynamic offer.\n\n**A note when automating: make sure you know the timezone of your server! Dates might be different if its using UTC.**\n\n![different data](https://images.ctfassets.net/on47yk52ubpi/4juJYuay1gamPWmHNwkx89/8d71d3ed102b35f9bd9edbeb0acbc071/1_O2hmfCedbg4zFwFwejprfA.webp)\n<figure>\n<figcaption>I continued writing this post the next day, thus my data has changed!</figcaption>\n</figure>\n\n## Updating the offer\n\nNow that I can get the data I need from Adobe Analytics. I want to take that data and put it into my offer programmatically. \nTo do this, I can use the [Target AIO Library](https://www.npmjs.com/package/@adobe/aio-lib-target) to get the offer, \nreplace the data, and update it. First lets get the offer:\n\n ```javascript\nconst auth = require('@adobe/jwt-auth');\nconst dotenv = require('dotenv');\nconst targetSDK = require('@adobe/aio-lib-target');\n\n// get my env variables\ndotenv.config();\n\n// Adobe API Config vars\nconst config = {\n  clientId: process.env.clientId,\n  clientSecret: process.env.clientSecret,\n  technicalAccountId: process.env.technicalAccountId,\n  orgId: process.env.orgId,\n  metaScopes: ['ent_analytics_bulk_ingest_sdk', 'ent_marketing_sdk'],\n  privateKey: process.env.privateKey.replace(/\\\\n/g, '\\n'), // make the PK readable as a string\n};\n\nasync function getTargetOffer() {\n  let { access_token } = await auth(config);\n  const targetClient = await targetSDK.init(process.env.tenant, config.clientId, access_token);\n  const offer = await targetClient.getOfferById(123456); // fake offer number\n  console.log(offer);\n}\n\ngetTargetOffer();\n```\n![aio get offer](https://images.ctfassets.net/on47yk52ubpi/3iTnQZtHZa7ul6dKfCpCFM/db02d0020659fbbe29576d61b5e5bc26/1_-71ZJ5X20ODZ_I4Y8Zc9lA.webp)\n\nThe contents of the offer (aka the code) can be found in the response under *obj.content*. \nI will be calling this offer, getting its current content, replacing the number that is \ncurrently in the message with the latest one from workspace, then calling the update function to update the content.\n\nThere’s a couple ways to do this, but the easiest is probably regex replace.\n The tricky part here is the content gets returned as a bunch of concatenated strings because Target is \n keeping the spacing that was present when I originally saved the offer. To make things a little easier on myself, \n I’m going to go open my offer in the Target UI, grab the code, and minify it. Then when I use the API, \n the offer content gets returned to me as a single string which I can use regex replace on:\n\n ![minified code from offer](https://images.ctfassets.net/on47yk52ubpi/31Epwr73YUm6LXbG2H02fL/579dd5df6067e27d57082bd79be6e33c/1_5NLaFzeETXbD1089Vg7H_Q.webp)\n <figure>\n<figcaption>Minified to a single string to make life a little easier. Be careful not to mixup quotation marks in the offer code</figcaption>\n</figure>\n\n```javascript\nasync function getTargetOffer() {\n  let { access_token } = await auth(config);\n  const targetClient = await targetSDK.init(process.env.tenant, config.clientId, access_token);\n  const offer = await targetClient.getOfferById(123456); // not the real offer ID\n  let currentOfferContent = offer.obj.content;\n  \n  // Im using \"700\" here just for illustrative purposes\n  let updatedOfferContent = currentOfferContent.replace(\n    'let message=\"n people viewed this product yesterday!\";',\n    `let message=\"700 people viewed this product yesterday!\";`\n  );\n  console.log(updatedOfferContent);\n}\n```\n\n![offer updated](https://images.ctfassets.net/on47yk52ubpi/7FmPvXkqTnqUL3oFh31D3s/3f79b30e56509e28e9ab8c8679f7c6e5/1_yH5_uVcIeDoRaH3jyWoYmw.webp)\n <figure>\n<figcaption>Finding and replacing the whole message string is the easiest way</figcaption>\n</figure>\n\nSo now that I have my updated offer content (the exact same offer code with just that number changed), I can call the updateOffer method with this new content.\n\n```javascript\nconst updateOffer = await targetClient.updateOffer(123456, { name: offer.obj.name, content: updatedOfferContent });\n```\n\nWhen using Target APIs, the UI is often slow to update. So if I were to go check in the offers UI I’d likely still see “n” instead of “700”. \nHowever, the delivery API uses the newest version when serving activities so the change would take effect almost immediately.\n\n![700 people gif](https://images.ctfassets.net/on47yk52ubpi/35K6AKBStZihcoU3rxJfKJ/081adffc03606e32c90b1404f851194a/1__uRqmCAh9ux8i6HVMh1ylA.gif)\n <figure>\n<figcaption>Wow!</figcaption>\n</figure>\n\n---\n\n## Putting it all together...\n\nSo now lets put it all together. Call Adobe Analytics for the data from yesterday, extract that number, and update the Target offer with that new number:\n\n```javascript\nconst auth = require('@adobe/jwt-auth');\nconst dotenv = require('dotenv');\nconst targetSDK = require('@adobe/aio-lib-target');\nconst aaSDK = require('@adobe/aio-lib-analytics');\n\n// get my env variables\ndotenv.config();\n\n// Adobe API Config vars\nconst config = {\n  clientId: process.env.clientId,\n  clientSecret: process.env.clientSecret,\n  technicalAccountId: process.env.technicalAccountId,\n  orgId: process.env.orgId,\n  metaScopes: ['ent_analytics_bulk_ingest_sdk', 'ent_marketing_sdk'],\n  privateKey: process.env.privateKey.replace(/\\\\n/g, '\\n'), // make the PK readable as a string\n};\nconst today = new Date();\nconst todayDate = today.toISOString().split('T')[0];\nconst yesterday = today.setDate(today.getDate() - 1);\nconst yesterdayDate = new Date(yesterday).toISOString().split('T')[0];\n\n// the query is truncated here, it may be longer in actuality\nconst query = {\n  rsid: process.env.rsid,\n  globalFilters: [\n    {\n      type: 'dateRange',\n      dateRange: `${yesterdayDate}T00:00:00.000/${todayDate}T00:00:00.000`,\n    },\n  ],\n  metricContainer: {\n    metrics: [\n      {\n        columnId: '0',\n        id: 'metrics/visitors',\n        sort: 'desc',\n      },\n    ],\n  },\n  dimension: 'variables/page',\n// etc \n// etc\n}\n\nasync function getAAData() {\n  // get bearer token\n  let { access_token } = await auth(config);\n\n  //initialize sdk\n  const aaClient = await aaSDK.init(process.env.companyId, config.clientId, access_token);\n\n  // Query the data\n  const myReport = await aaClient.getReport(query);\n  let { rows } = myReport.obj;\n\n  // the first number in the first data row\n  let number = rows[0].data.pop();\n  return number;\n}\n\nasync function updateTargetOffer() {\n  let { access_token } = await auth(config);\n  const targetClient = await targetSDK.init(process.env.tenant, config.clientId, access_token);\n  const offer = await targetClient.getOfferById(process.env.offerID); // not the real offer ID\n  const number = await getAAData();\n  let currentOfferContent = offer.obj.content;\n  let updatedOfferContent = currentOfferContent.replace(\n    /let message=\".+ people viewed this product yesterday!\"/g,\n    `let message=\"${number.toLocaleString('en-us')} people viewed this product yesterday!\";`\n  );\n  const updateOffer = await targetClient.updateOffer(process.env.offerID, { name: offer.obj.name, content: updatedOfferContent });\n  return updateOffer;\n}\n\nupdateTargetOffer();\n```\n\nA few things to call out in the code above:\n\n* Metascopes in the configuration; In addition to API setup in the developer console, you have to make sure you are using the correct metascopes in your API calls. [More on metascopes here](https://developer.adobe.com/developer-console/docs/guides/authentication/JWT/Scopes/).\n* The regex replacement for the message content is intentionally vague to account for punctuation in number formatting. Also, it is an actual regex now because after the first run, the message will have a number in it instead of *“n”*\n* The number string uses USA style formatting using the *toLocaleString* method. It would be cool to dynamically set this with Target geo profiling somehow…\n* Calling *updateOffer* requires the offer name for some reason even though you are already sending the ID…\n* I moved the offer ID to an environment variable to make this code more reusable. You could also move it to a command line argument.\n\n![updated offer code from api](https://images.ctfassets.net/on47yk52ubpi/1NUlRWMX1kuQfifEmljYnr/5372b421acffecf1d1f849e93b344545/1_YeEPYEnlFlPubE36yC6rfQ.webp)\n <figure>\n<figcaption>Actual, formatted number of unique visitors to a page in an offer and ready to be served via an Activity</figcaption>\n</figure>\n\n![working popup](https://images.ctfassets.net/on47yk52ubpi/2G9o1gc0y6MlFxMx9DFX3H/1bce0c185a940969d3a77204a765a503/1_Hz8qdbiWIV95i5wyPntVoQ.gif)\n<figure>\n<figcaption>A Target offer that uses real data!</figcaption>\n</figure>\n \n![updated offer code in target ui](https://images.ctfassets.net/on47yk52ubpi/7oNoiB9WCc99jUYgUdZjW3/a96ac93a679a1f2e1ee5c1457a1aadd5/1_S7gWx9CyeVmvHRprNRinjw.webp)\n<figure>\n<figcaption>Remember that the UI won’t update immediately, but it will update eventually!</figcaption>\n</figure>\n\n## Automation & Conclusion\n\nIn order for this setup actually useful, it needs to be automated to run every day so that the offer always shows the previous day’s data. \nSince the activity just serves the offer, there is no need to touch the activity once it is activated. It will just serve the latest version of the offer whatever that happens to be.\n\nThere are a few options for automating the offer update code daily. A cron job on a linux virtual machine or via an AWS Lambda\n with AWS Event Bridge are the two most obvious choices. There are plently of resources out there to help you learn about those!\n\nFollowing all the steps above and putting the code into an automation process will allow you to run a Target experience that shows an offer that shows real data!",
    "code": "var Component=(()=>{var p=Object.create;var o=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var N=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=>{for(var c in s)o(a,c,{get:s[c],enumerable:!0})},l=(a,s,c,n)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let t of h(s))!u.call(a,t)&&t!==c&&o(a,t,{get:()=>s[t],enumerable:!(n=d(s,t))||n.enumerable});return a};var f=(a,s,c)=>(c=a!=null?p(m(a)):{},l(s||!a||!a.__esModule?o(c,\"default\",{value:a,enumerable:!0}):c,a)),g=a=>l(o({},\"__esModule\",{value:!0}),a);var r=N((A,i)=>{i.exports=_jsx_runtime});var v={};k(v,{default:()=>b,frontmatter:()=>y});var e=f(r()),y={title:\"Using data from Adobe Analytics in Adobe Target Offers\",date:\"2022-12-16\",tags:[\"adobe analytics\",\"adobe target\",\"testing\"],draft:!1,summary:\"How to use data pulled from Adobe Analytics in an Adobe Target offer.\"};function w(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",p:\"p\",em:\"em\",strong:\"strong\",img:\"img\",ul:\"ul\",li:\"li\",hr:\"hr\",pre:\"pre\",code:\"code\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"do-social-proof-ctas-actually-work\",children:[(0,e.jsx)(n.a,{href:\"#do-social-proof-ctas-actually-work\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Do social proof CTAs actually work?\"]}),(0,e.jsxs)(n.p,{children:[\"I\\u2019m sure everyone has seen those popups on online stores that say something like \",(0,e.jsx)(n.em,{children:\"\\u201C15 people are viewing this product right now!\\u201D\"}),\" or \",(0,e.jsx)(n.em,{children:\"\\u201C105 other people from Michigan bought this yesterday!\\u201D\"}),\". I actually looked around for one in the wild to include a screenshot, but of course, when I need one, I can\\u2019t find one. Anyway, I\\u2019m going to build one of those in Target that uses \",(0,e.jsx)(n.strong,{children:\"real data\"}),\" pulled from Adobe Analytics.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"popupexample\",src:\"https://images.ctfassets.net/on47yk52ubpi/LX2R2PAXrJFZyJDVmeppD/48d92270accf82b3eb77bf992fcb291f/1_eDd83lpg7ihAxJgoYkfOcw.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"This type of thing!\"})}),(0,e.jsxs)(n.p,{children:[\"In this example, for simplicity, lets say I have a product page, running an A/B activity in Target for all visitors. 50% of visitors to this page will get a pop up that \\u201Cencourages\\u201D them to make a purchase by saying something like: \",(0,e.jsx)(n.em,{children:\"\\u201Cn-number of people viewed this product yesterday!\\u201D\"}),\" and the other 50% of visitors will get the default experience of no such popup. The \",(0,e.jsx)(n.em,{children:\"n-number\"}),\" used in the popup content will be a real number of unique visitors who viewed that product page yesterday just as it is reflected in an Adobe Analytics Workspace table. The number will change daily to reflect the previous day\\u2019s data relative to the current date; i.e. a visitor on the 12th will see data from the 11th, a visitor on the 13th will see data from the 12th, etc.\"]}),(0,e.jsxs)(n.p,{children:[\"The example I create will be trivial, but concepts will apply to showing \",(0,e.jsx)(n.em,{children:\"anything\"}),\" from a workspace table in a Target offer!\"]}),(0,e.jsxs)(n.h2,{id:\"general-overview\",children:[(0,e.jsx)(n.a,{href:\"#general-overview\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"General overview\"]}),(0,e.jsxs)(n.p,{children:[\"As with \",(0,e.jsx)(n.em,{children:\"almost\"}),\" everything I write about these days, for the sake of brevity, I have to assume some prior knowledge of the \",(0,e.jsx)(n.a,{href:\"https://developer.adobe.com/developer-console/\",children:\"Adobe Developer Console\"}),\", some programming experience, and familiarity with Target and Adobe Analytics terminology.\"]}),(0,e.jsx)(n.p,{children:\"Here are the steps:\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"Hack together the popup element using a placeholder number.\"}),(0,e.jsx)(n.li,{children:\"Save the code from above as a Target Offer. Note the offer ID after saving.\"}),(0,e.jsxs)(n.li,{children:[\"Build the activity in Target with the 2 experiences using the \",(0,e.jsx)(n.a,{href:\"https://experienceleague.adobe.com/docs/target/using/experiences/form-experience-composer.html?lang=en\",children:\"form composer\"}),\" and set the delivery content in the variant experience to be the offer I just saved above.\"]}),(0,e.jsxs)(n.li,{children:[\"In workspace now, build a report that shows the number I want to display in the offer. Use the \",(0,e.jsx)(n.a,{href:\"https://developer.adobe.com/cja-apis/docs/endpoints/reporting/debugger/\",children:\"Oberon debugger\"}),\" to grab the parameters used to make that report as JSON.\"]}),(0,e.jsx)(n.li,{children:\"Setup a developer console project that has access to the Target API and the Adobe Analytics API. I will need the API keys in the next step.\"}),(0,e.jsxs)(n.li,{children:[\"Write some NodeJS using the \",(0,e.jsx)(n.a,{href:\"https://www.npmjs.com/search?q=adobe%20aio\",children:\"Adobe AIO libraries\"}),\" to pull that number from workspace and update your Target offer to use that number.\"]}),(0,e.jsx)(n.li,{children:\"Automate the NodeJS above to update the offer with new data every day (or however often you want it to update)\"}),(0,e.jsx)(n.li,{children:(0,e.jsx)(n.em,{children:\"Note: For this example lets assume its a desktop only audience. I would never willingly encourge anyone to put a popup on mobile!\"})})]}),(0,e.jsx)(n.hr,{}),(0,e.jsxs)(n.h2,{id:\"build-the-popup\",children:[(0,e.jsx)(n.a,{href:\"#build-the-popup\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Build the popup\"]}),(0,e.jsx)(n.p,{children:\"Since I will be serving a chunk of HTML as my Target offer, I need a self contained, complete piece of code that builds the popup, styles it, etc. You could simplify this part by just replacing some static text like a headline or CTA, but I already said popup and my delete key is broken. I don\\u2019t remember the keyframes syntax for having things animate directionally in, so lets just have the popup fade in:\"}),(0,e.jsx)(n.pre,{className:\"language-javascript\",children:(0,e.jsxs)(n.code,{className:\"language-javascript code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" popup \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"document\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"createElement\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'div'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"popup\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"id\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'popup'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" content \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"document\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"createElement\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'p'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" keyframes \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"document\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"createElement\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'style'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"keyframes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"innerText\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'#popup {font-weight: bold !important;height: 100px !important;width: 350px !important;background-color: #fff !important;border: 3px solid red !important;position: absolute !important;bottom: 0 !important;margin: 1em !important;padding: 1em !important;border-radius: 1em !important;-webkit-animation: popin 4s forwards !important;animation-name: popin 4s forwards !important;}@-webkit-keyframes popin {from {opacity: 0;}to {opacity: 1;}}@keyframes popup {from {opacity: 0;}to {opacity: 1;}}'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"document\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"querySelector\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'head'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"insertAdjacentElement\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'beforeend'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" keyframes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" message \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'n people viewed this product yesterday!'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"content\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"innerText\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" message\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"popup\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"appendChild\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"content\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token dom variable\",children:\"document\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"querySelector\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'body'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"appendChild\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"popup\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"n number of people viewed\",src:\"https://images.ctfassets.net/on47yk52ubpi/6NXOVx8Iv1YkEfzXiVsSVE/ddcb853ac246f7ae28fb0cd2b27ebcc2/1_d_7nt3bXF98bud9bwPeG8w.gif\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"An incredibly enticing popup box with placeholder content. Who are you to resist it?!\"})}),(0,e.jsxs)(n.h2,{id:\"save-it-as-an-offer\",children:[(0,e.jsx)(n.a,{href:\"#save-it-as-an-offer\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Save it as an offer\"]}),(0,e.jsx)(n.p,{children:\"Now that I have the popup I want to serve in one of my Target experiences, I need to save it as an offer. Once it is saved as an offer, I will be able to deliver it in any Activity and more easily interact with it via the Target API.\"}),(0,e.jsxs)(n.p,{children:[\"Since I am technically delivering HTML in need to wrap this code in a \",(0,e.jsx)(n.code,{children:\"<script>\"}),\" tag so it is valid HTML: \",(0,e.jsx)(n.img,{alt:\"save as offer\",src:\"https://images.ctfassets.net/on47yk52ubpi/6hwD3HxzfppywMRNNlG63X/0dbc6c41ded784fc5b7843434904f592/1_jQclFe_vk_L19eG8ccRYJw.webp\"})]}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"New HTML Offer\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"fake offer code\",src:\"https://images.ctfassets.net/on47yk52ubpi/61fP41uUz2haec6Psdc9hH/ac43f41dd9ed00c448e43df0a7d2f8ee/1_Mxm-OiWKLPnEQwiXPCCQuQ.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"Make sure the code your delivering is valid HTML\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"grab the offer id\",src:\"https://images.ctfassets.net/on47yk52ubpi/2N45TpzFFe6BqcrJiZU54M/3e68a814c42c7b11b3a0eca89839e4dd/1__B06TB_Y1Pu3Es7j6sjjHw.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"Grab the offer ID while you are here!\"})}),(0,e.jsx)(n.p,{children:\"Once the offer is saved, bring up this info box by clicking the (i) icon in the modify column and save the Offer ID for later!\"}),(0,e.jsxs)(n.h2,{id:\"build-the-activity-in-target\",children:[(0,e.jsx)(n.a,{href:\"#build-the-activity-in-target\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Build the Activity in Target\"]}),(0,e.jsxs)(n.p,{children:[\"If you\\u2019ve never used the form composer, its a little difference than the VEC. You need to have all the specifics of your Activity ready to go. \",(0,e.jsx)(n.a,{href:\"https://experienceleague.adobe.com/docs/target/using/experiences/form-experience-composer.html?lang=en\",children:\"The official form composer docs are here\"}),\".\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"form composer setup\",src:\"https://images.ctfassets.net/on47yk52ubpi/MIMchv6VFEDvOHN1zemC7/49dbf7c0d32566dc11372b188c4b0047/1_vOKzHvOkgSAr-xc0GD1ElQ.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"The setup for my popup offer experience in Target\"})}),(0,e.jsx)(n.p,{children:\"That\\u2019s it in the Target UI until its time to activate the test!\"}),(0,e.jsx)(n.hr,{}),(0,e.jsxs)(n.h2,{id:\"getting-the-data-i-want-to-use-in-my-offer-from-adobe-analytics\",children:[(0,e.jsx)(n.a,{href:\"#getting-the-data-i-want-to-use-in-my-offer-from-adobe-analytics\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Getting the data I want to use in my Offer from Adobe Analytics\"]}),(0,e.jsxs)(n.p,{children:[\"The first step to being able to pull the data I want via the API is to generate it from a report in workspace. While this is not \",(0,e.jsx)(n.em,{children:\"technically\"}),\" necessary, Adobe\\u2019s Oberon debugging tool makes interacting with the reporting API \",(0,e.jsx)(n.strong,{children:\"much, much\"}),\" easier. Here\\u2019s what my desired data looks like in workspace, the number of unique visitors to my product page yesterday:\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"workspace setup data\",src:\"https://images.ctfassets.net/on47yk52ubpi/4qBPqYz8ZxiC8Fwp2Nhqz2/0bfe5046a76fd2555d2ecbe69f5b2827/1_arBiuRigeG2U0Vy2VMLhug.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"1,388 will change every day. Thus the number in the pop up will change every day!\"})}),(0,e.jsxs)(n.p,{children:[\"In order to view (and steal) the underlying API query that made this report, I need to first enable the debugger. To do so, make sure the project is saved and go to \",(0,e.jsx)(n.em,{children:\"Help > Enable Debugger\"}),\". Enabling the debugger will add this little bug guy to your freeform tables. Click it, and you can see the underlying JSON & XML queries the Adobe Analytics API used to generate the data for the table. Depending on how much work you have done on the table, you will also see historical snapshots of queries it has used.\"]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"enable debugger\",src:\"https://images.ctfassets.net/on47yk52ubpi/5VnYOncJiVuPpjXPcebhPx/ff6502e88fa2f01199dc22e31afe0006/1_kJPPtqkeyVlhteJYYaMu4Q.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"How to enable the debugger\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"oberon bug\",src:\"https://images.ctfassets.net/on47yk52ubpi/5EGfYGHehMBVWNWFtFiyva/fc2b64be16a2d61dd5805db5567567de/1_AFq2k7pVu2MIEW2fjvMr3g.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"Click the little bug fella in your panel\"})}),(0,e.jsx)(n.p,{children:\"This is what I am looking for inside the debug view. I will use this chunk of JSON later on when I need to programmatically pull this data.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"oberon json\",src:\"https://images.ctfassets.net/on47yk52ubpi/3LVKr2P63ZnjvRAH4DWwum/d7cab2b8604e7456a37933042a9551b4/1_X9x755hhoK5lcxlHTZ3t6A.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"This is the JSON that Workspace uses to query Adobe Analytics data! In the UI there will also be the response from the API just to the right of here where you will see the data represented.\"})}),(0,e.jsx)(n.p,{children:\"Jumping ahead a little bit, when I make this call via the Node SDK, you can see that the data is the same as in workspace. That is because I am doing the exact same thing workspace is doing!\"}),(0,e.jsx)(n.pre,{className:\"language-javascript\",children:(0,e.jsxs)(n.code,{className:\"language-javascript code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" auth \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'@adobe/jwt-auth'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" aaSDK \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'@adobe/aio-lib-analytics'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" dotenv \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'dotenv'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// get my env variables\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"dotenv\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"config\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Adobe API Config vars\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" config \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  clientId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  clientSecret\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientSecret\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  technicalAccountId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"technicalAccountId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  orgId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"orgId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  metaScopes\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'ent_analytics_bulk_ingest_sdk'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  privateKey\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"privateKey\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"replace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token regex\",children:[(0,e.jsx)(n.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,e.jsxs)(n.span,{className:\"token language-regex regex-source\",children:[(0,e.jsx)(n.span,{className:\"token escape special-escape\",children:\"\\\\\\\\\"}),\"n\"]}),(0,e.jsx)(n.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token regex-flags\",children:\"g\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'\\\\n'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// make the PK readable as a string\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// json query goes here, I left it out here to save space\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" query \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getAAData\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// get bearer token\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" access_token \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"auth\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"config\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"//initialize sdk\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" aaClient \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" aaSDK\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"init\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"companyId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" config\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" access_token\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Query the data\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" myReport \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" aaClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"getReport\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"query\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token class-name console\",children:\"console\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"log\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token class-name known-class-name\",children:\"JSON\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"stringify\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"myReport\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"obj\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"rows\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword nil null\",children:\"null\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"4\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"getAAData\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"code output\",src:\"https://images.ctfassets.net/on47yk52ubpi/7m583CXdTSSElIfI8aQqot/be989732335a7052055ae3cf4f5249ee/1_q7TZUjU8IY2rmmnAVwGFfQ.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"1388! The same number from workspace!\"})}),(0,e.jsxs)(n.h2,{id:\"making-the-query-dynamic\",children:[(0,e.jsx)(n.a,{href:\"#making-the-query-dynamic\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Making the query dynamic\"]}),(0,e.jsx)(n.p,{children:\"In order to make my query dynamic and return the data from the previous day, I need to inject the previous date into it. Although the workspace date range says \\u201CYesterday\\u201D, in the query you can see it uses actual dates instead of a keyword:\"}),(0,e.jsx)(n.pre,{className:\"language-javascript\",children:(0,e.jsxs)(n.code,{className:\"language-javascript code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"globalFilters\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      type\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'dateRange'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      dateRange\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'2022-12-13T00:00:00.000/2022-12-14T00:00:00.000'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"This is good though, because that means I can just replace the hardcoded dates with whatever date range I want. In this case, the dates of \\u201Ctoday\\u201D and \\u201Cyesterday\\u201D\"}),(0,e.jsx)(n.pre,{className:\"language-javascript\",children:(0,e.jsxs)(n.code,{className:\"language-javascript code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" today \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"Date\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" todayDate \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" today\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"toISOString\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"split\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'T'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" yesterday \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" today\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"setDate\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"today\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"getDate\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" yesterdayDate \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"Date\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"yesterday\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"toISOString\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"split\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'T'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" query \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" rsid\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"rsid\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" globalFilters\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     type\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'dateRange'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"     dateRange\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"yesterdayDate\",(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:\"T00:00:00.000/\"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"todayDate\",(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:\"T00:00:00.000\"}),(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"   \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" etc etc \",(0,e.jsx)(n.span,{className:\"token operator spread\",children:\"...\"}),(0,e.jsx)(n.span,{className:\"token operator spread\",children:\"...\"}),(0,e.jsx)(n.span,{className:\"token operator spread\",children:\"...\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"There\\u2019s probably a more elegant way to do this way a newer date library from NPM, but this works. So now my report will always pull the previous day\\u2019s data, relative to the current date. Exactly the data I want to use in my dynamic offer.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.strong,{children:\"A note when automating: make sure you know the timezone of your server! Dates might be different if its using UTC.\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"different data\",src:\"https://images.ctfassets.net/on47yk52ubpi/4juJYuay1gamPWmHNwkx89/8d71d3ed102b35f9bd9edbeb0acbc071/1_O2hmfCedbg4zFwFwejprfA.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"I continued writing this post the next day, thus my data has changed!\"})}),(0,e.jsxs)(n.h2,{id:\"updating-the-offer\",children:[(0,e.jsx)(n.a,{href:\"#updating-the-offer\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Updating the offer\"]}),(0,e.jsxs)(n.p,{children:[\"Now that I can get the data I need from Adobe Analytics. I want to take that data and put it into my offer programmatically. To do this, I can use the \",(0,e.jsx)(n.a,{href:\"https://www.npmjs.com/package/@adobe/aio-lib-target\",children:\"Target AIO Library\"}),\" to get the offer, replace the data, and update it. First lets get the offer:\"]}),(0,e.jsx)(n.pre,{className:\"language-javascript\",children:(0,e.jsxs)(n.code,{className:\"language-javascript code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" auth \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'@adobe/jwt-auth'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" dotenv \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'dotenv'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" targetSDK \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'@adobe/aio-lib-target'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// get my env variables\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"dotenv\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"config\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Adobe API Config vars\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" config \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" clientId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" clientSecret\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientSecret\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" technicalAccountId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"technicalAccountId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" orgId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"orgId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" metaScopes\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'ent_analytics_bulk_ingest_sdk'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'ent_marketing_sdk'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" privateKey\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"privateKey\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"replace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token regex\",children:[(0,e.jsx)(n.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,e.jsxs)(n.span,{className:\"token language-regex regex-source\",children:[(0,e.jsx)(n.span,{className:\"token escape special-escape\",children:\"\\\\\\\\\"}),\"n\"]}),(0,e.jsx)(n.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token regex-flags\",children:\"g\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'\\\\n'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// make the PK readable as a string\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getTargetOffer\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" access_token \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"auth\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"config\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" targetClient \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetSDK\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"init\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"tenant\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" config\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" access_token\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" offer \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"getOfferById\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"123456\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// fake offer number\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\" \",(0,e.jsx)(n.span,{className:\"token class-name console\",children:\"console\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"log\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"offer\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"getTargetOffer\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"aio get offer\",src:\"https://images.ctfassets.net/on47yk52ubpi/3iTnQZtHZa7ul6dKfCpCFM/db02d0020659fbbe29576d61b5e5bc26/1_-71ZJ5X20ODZ_I4Y8Zc9lA.webp\"})}),(0,e.jsxs)(n.p,{children:[\"The contents of the offer (aka the code) can be found in the response under \",(0,e.jsx)(n.em,{children:\"obj.content\"}),\". I will be calling this offer, getting its current content, replacing the number that is currently in the message with the latest one from workspace, then calling the update function to update the content.\"]}),(0,e.jsx)(n.p,{children:\"There\\u2019s a couple ways to do this, but the easiest is probably regex replace. The tricky part here is the content gets returned as a bunch of concatenated strings because Target is keeping the spacing that was present when I originally saved the offer. To make things a little easier on myself, I\\u2019m going to go open my offer in the Target UI, grab the code, and minify it. Then when I use the API, the offer content gets returned to me as a single string which I can use regex replace on:\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"minified code from offer\",src:\"https://images.ctfassets.net/on47yk52ubpi/31Epwr73YUm6LXbG2H02fL/579dd5df6067e27d57082bd79be6e33c/1_5NLaFzeETXbD1089Vg7H_Q.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"Minified to a single string to make life a little easier. Be careful not to mixup quotation marks in the offer code\"})}),(0,e.jsx)(n.pre,{className:\"language-javascript\",children:(0,e.jsxs)(n.code,{className:\"language-javascript code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getTargetOffer\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" access_token \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"auth\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"config\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" targetClient \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetSDK\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"init\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"tenant\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" config\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" access_token\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" offer \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"getOfferById\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"123456\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// not the real offer ID\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" currentOfferContent \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" offer\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"obj\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"content\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`  \n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:'// Im using \"700\" here just for illustrative purposes'}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" updatedOfferContent \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" currentOfferContent\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"replace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token string\",children:`'let message=\"n people viewed this product yesterday!\";'`}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'let message=\"700 people viewed this product yesterday!\";'}),(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token class-name console\",children:\"console\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"log\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"updatedOfferContent\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"offer updated\",src:\"https://images.ctfassets.net/on47yk52ubpi/7FmPvXkqTnqUL3oFh31D3s/3f79b30e56509e28e9ab8c8679f7c6e5/1_yH5_uVcIeDoRaH3jyWoYmw.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"Finding and replacing the whole message string is the easiest way\"})}),(0,e.jsx)(n.p,{children:\"So now that I have my updated offer content (the exact same offer code with just that number changed), I can call the updateOffer method with this new content.\"}),(0,e.jsx)(n.pre,{className:\"language-javascript\",children:(0,e.jsx)(n.code,{className:\"language-javascript code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" updateOffer \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"updateOffer\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"123456\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" name\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" offer\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"obj\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" content\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" updatedOfferContent \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})})}),(0,e.jsx)(n.p,{children:\"When using Target APIs, the UI is often slow to update. So if I were to go check in the offers UI I\\u2019d likely still see \\u201Cn\\u201D instead of \\u201C700\\u201D. However, the delivery API uses the newest version when serving activities so the change would take effect almost immediately.\"}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"700 people gif\",src:\"https://images.ctfassets.net/on47yk52ubpi/35K6AKBStZihcoU3rxJfKJ/081adffc03606e32c90b1404f851194a/1__uRqmCAh9ux8i6HVMh1ylA.gif\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"Wow!\"})}),(0,e.jsx)(n.hr,{}),(0,e.jsxs)(n.h2,{id:\"putting-it-all-together\",children:[(0,e.jsx)(n.a,{href:\"#putting-it-all-together\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Putting it all together...\"]}),(0,e.jsx)(n.p,{children:\"So now lets put it all together. Call Adobe Analytics for the data from yesterday, extract that number, and update the Target offer with that new number:\"}),(0,e.jsx)(n.pre,{className:\"language-javascript\",children:(0,e.jsxs)(n.code,{className:\"language-javascript code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" auth \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'@adobe/jwt-auth'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" dotenv \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'dotenv'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" targetSDK \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'@adobe/aio-lib-target'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" aaSDK \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"require\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'@adobe/aio-lib-analytics'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// get my env variables\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"dotenv\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"config\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Adobe API Config vars\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" config \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  clientId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  clientSecret\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientSecret\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  technicalAccountId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"technicalAccountId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  orgId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"orgId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  metaScopes\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'ent_analytics_bulk_ingest_sdk'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'ent_marketing_sdk'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  privateKey\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"privateKey\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"replace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsxs)(n.span,{className:\"token regex\",children:[(0,e.jsx)(n.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,e.jsxs)(n.span,{className:\"token language-regex regex-source\",children:[(0,e.jsx)(n.span,{className:\"token escape special-escape\",children:\"\\\\\\\\\"}),\"n\"]}),(0,e.jsx)(n.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token regex-flags\",children:\"g\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'\\\\n'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// make the PK readable as a string\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" today \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"Date\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" todayDate \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" today\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"toISOString\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"split\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'T'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" yesterday \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" today\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"setDate\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"today\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"getDate\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"1\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" yesterdayDate \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"new\"}),\" \",(0,e.jsx)(n.span,{className:\"token class-name\",children:\"Date\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"yesterday\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"toISOString\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"split\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'T'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// the query is truncated here, it may be longer in actuality\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" query \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  rsid\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"rsid\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  globalFilters\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      type\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'dateRange'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      dateRange\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"yesterdayDate\",(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:\"T00:00:00.000/\"}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"todayDate\",(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:\"T00:00:00.000\"}),(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  metricContainer\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    metrics\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        columnId\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'0'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        id\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'metrics/visitors'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        sort\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'desc'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  dimension\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'variables/page'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// etc \"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"// etc\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getAAData\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// get bearer token\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" access_token \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"auth\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"config\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"//initialize sdk\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" aaClient \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" aaSDK\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"init\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"companyId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" config\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" access_token\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// Query the data\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" myReport \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" aaClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"getReport\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"query\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" rows \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" myReport\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"obj\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// the first number in the first data row\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" number \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" rows\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"0\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"data\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"pop\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" number\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token keyword\",children:\"async\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"function\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"updateTargetOffer\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" access_token \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"auth\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"config\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" targetClient \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetSDK\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"init\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"tenant\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" config\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"clientId\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" access_token\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" offer \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"getOfferById\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"offerID\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"// not the real offer ID\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" number \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"getAAData\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" currentOfferContent \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" offer\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"obj\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"content\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"let\"}),\" updatedOfferContent \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" currentOfferContent\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"replace\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxs)(n.span,{className:\"token regex\",children:[(0,e.jsx)(n.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,e.jsxs)(n.span,{className:\"token language-regex regex-source\",children:['let message=\"',(0,e.jsx)(n.span,{className:\"token class-name charclass\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token number quantifier\",children:\"+\"}),' people viewed this product yesterday!\"']}),(0,e.jsx)(n.span,{className:\"token regex-delimiter\",children:\"/\"}),(0,e.jsx)(n.span,{className:\"token regex-flags\",children:\"g\"})]}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsxs)(n.span,{className:\"token template-string\",children:[(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'let message=\"'}),(0,e.jsxs)(n.span,{className:\"token interpolation\",children:[(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"${\"}),\"number\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"toLocaleString\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token string\",children:\"'en-us'\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation interpolation-punctuation\",children:\"}\"})]}),(0,e.jsx)(n.span,{className:\"token string\",children:' people viewed this product yesterday!\";'}),(0,e.jsx)(n.span,{className:\"token string template-punctuation\",children:\"`\"})]}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword\",children:\"const\"}),\" updateOffer \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\" \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"await\"}),\" targetClient\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access function method\",children:\"updateOffer\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"process\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"offerID\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\" name\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" offer\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"obj\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\".\"}),(0,e.jsx)(n.span,{className:\"token property-access\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" content\",(0,e.jsx)(n.span,{className:\"token operator\",children:\":\"}),\" updatedOfferContent \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token keyword control-flow\",children:\"return\"}),\" updateOffer\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"updateTargetOffer\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\";\"}),`\n`]})]})}),(0,e.jsx)(n.p,{children:\"A few things to call out in the code above:\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsxs)(n.li,{children:[\"Metascopes in the configuration; In addition to API setup in the developer console, you have to make sure you are using the correct metascopes in your API calls. \",(0,e.jsx)(n.a,{href:\"https://developer.adobe.com/developer-console/docs/guides/authentication/JWT/Scopes/\",children:\"More on metascopes here\"}),\".\"]}),(0,e.jsxs)(n.li,{children:[\"The regex replacement for the message content is intentionally vague to account for punctuation in number formatting. Also, it is an actual regex now because after the first run, the message will have a number in it instead of \",(0,e.jsx)(n.em,{children:\"\\u201Cn\\u201D\"})]}),(0,e.jsxs)(n.li,{children:[\"The number string uses USA style formatting using the \",(0,e.jsx)(n.em,{children:\"toLocaleString\"}),\" method. It would be cool to dynamically set this with Target geo profiling somehow\\u2026\"]}),(0,e.jsxs)(n.li,{children:[\"Calling \",(0,e.jsx)(n.em,{children:\"updateOffer\"}),\" requires the offer name for some reason even though you are already sending the ID\\u2026\"]}),(0,e.jsx)(n.li,{children:\"I moved the offer ID to an environment variable to make this code more reusable. You could also move it to a command line argument.\"})]}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"updated offer code from api\",src:\"https://images.ctfassets.net/on47yk52ubpi/1NUlRWMX1kuQfifEmljYnr/5372b421acffecf1d1f849e93b344545/1_YeEPYEnlFlPubE36yC6rfQ.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"Actual, formatted number of unique visitors to a page in an offer and ready to be served via an Activity\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"working popup\",src:\"https://images.ctfassets.net/on47yk52ubpi/2G9o1gc0y6MlFxMx9DFX3H/1bce0c185a940969d3a77204a765a503/1_Hz8qdbiWIV95i5wyPntVoQ.gif\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"A Target offer that uses real data!\"})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.img,{alt:\"updated offer code in target ui\",src:\"https://images.ctfassets.net/on47yk52ubpi/7oNoiB9WCc99jUYgUdZjW3/a96ac93a679a1f2e1ee5c1457a1aadd5/1_S7gWx9CyeVmvHRprNRinjw.webp\"})}),(0,e.jsx)(\"figure\",{children:(0,e.jsx)(\"figcaption\",{children:\"Remember that the UI won\\u2019t update immediately, but it will update eventually!\"})}),(0,e.jsxs)(n.h2,{id:\"automation--conclusion\",children:[(0,e.jsx)(n.a,{href:\"#automation--conclusion\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Automation & Conclusion\"]}),(0,e.jsx)(n.p,{children:\"In order for this setup actually useful, it needs to be automated to run every day so that the offer always shows the previous day\\u2019s data. Since the activity just serves the offer, there is no need to touch the activity once it is activated. It will just serve the latest version of the offer whatever that happens to be.\"}),(0,e.jsx)(n.p,{children:\"There are a few options for automating the offer update code daily. A cron job on a linux virtual machine or via an AWS Lambda with AWS Event Bridge are the two most obvious choices. There are plently of resources out there to help you learn about those!\"}),(0,e.jsx)(n.p,{children:\"Following all the steps above and putting the code into an automation process will allow you to run a Target experience that shows an offer that shows real data!\"})]})}}var b=w;return g(v);})();\n;return Component;"
  },
  "_id": "blog/using-data-from-adobe-analytics-in-adobe-target-offers.mdx",
  "_raw": {
    "sourceFilePath": "blog/using-data-from-adobe-analytics-in-adobe-target-offers.mdx",
    "sourceFileName": "using-data-from-adobe-analytics-in-adobe-target-offers.mdx",
    "sourceFileDir": "blog",
    "contentType": "mdx",
    "flattenedPath": "blog/using-data-from-adobe-analytics-in-adobe-target-offers"
  },
  "type": "Blog",
  "readingTime": {
    "text": "14 min read",
    "minutes": 13.215,
    "time": 792900,
    "words": 2643
  },
  "slug": "using-data-from-adobe-analytics-in-adobe-target-offers",
  "toc": [
    {
      "value": "Do social proof CTAs actually work?",
      "url": "#do-social-proof-ctas-actually-work",
      "depth": 2
    },
    {
      "value": "General overview",
      "url": "#general-overview",
      "depth": 2
    },
    {
      "value": "Build the popup",
      "url": "#build-the-popup",
      "depth": 2
    },
    {
      "value": "Save it as an offer",
      "url": "#save-it-as-an-offer",
      "depth": 2
    },
    {
      "value": "Build the Activity in Target",
      "url": "#build-the-activity-in-target",
      "depth": 2
    },
    {
      "value": "Getting the data I want to use in my Offer from Adobe Analytics",
      "url": "#getting-the-data-i-want-to-use-in-my-offer-from-adobe-analytics",
      "depth": 2
    },
    {
      "value": "Making the query dynamic",
      "url": "#making-the-query-dynamic",
      "depth": 2
    },
    {
      "value": "Updating the offer",
      "url": "#updating-the-offer",
      "depth": 2
    },
    {
      "value": "Putting it all together...",
      "url": "#putting-it-all-together",
      "depth": 2
    },
    {
      "value": "Automation & Conclusion",
      "url": "#automation--conclusion",
      "depth": 2
    }
  ]
}